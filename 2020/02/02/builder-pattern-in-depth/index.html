<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keywords" content="ZWT, Blog, Spring å¾®æœåŠ¡, æ‹›æ–‡æ¡ƒ, Spring Boot, gdouzwt">
    <meta name="theme-color" content="#000000">

    <title>æ·±å…¥ç”Ÿæˆå™¨è®¾è®¡æ¨¡å¼ - æ‹›æ–‡æ¡ƒ | è®°å½•</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">

    <!-- Safari Webpage Icon    by-BY -->
    <link rel="apple-touch-icon" href="/img/apple-touch-icon.png">

    <!-- Canonical URL -->
    <link rel="canonical" href="https://zwt.io/2020/02/02/builder-pattern-in-depth/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/zwt.min.css">

    <!-- <link rel="stylesheet" href="/css/asciidoctor.css"> -->

    <!-- <link rel="stylesheet" href="/css/prism.css"> -->

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" rel="stylesheet" type="text/css">

    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css"> -->

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand logo" href="/" style="padding: 0; margin: 0">
                <img src="/img/brand-logo.png"  style="cursor: pointer;padding: 6px" alt="logo">
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">ä¸»é¡µ</a>
                    </li>
                    
                    <li>
                        <a href="/about/">å…³äº</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">æ ‡ç­¾</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstrap low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf junk-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


<!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/leimu.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/img/leimu.jpg')
    }

    
</style>
<header class="intro-header" >
    <div class="header-mask"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Design Pattern" title="Design Pattern">Design Pattern</a>
                        
                        <a class="tag" href="/tags/#è®¾è®¡æ¨¡å¼" title="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼</a>
                        
                    </div>
                    <h1>æ·±å…¥ç”Ÿæˆå™¨è®¾è®¡æ¨¡å¼</h1>
                    
                    
                    <h2 class="subheading">Builder Pattern in Depth</h2>
                    
                    <span class="meta">2020å¹´2æœˆ2æ—¥å‘å¸ƒğŸ“‘</span>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
    <div class="
        col-lg-8 col-lg-offset-2
        col-md-10 col-md-offset-1
        post-container">

        <h3 id="gof-å®šä¹‰">GoF å®šä¹‰</h3>

<blockquote>
  <p>Separate the construction of a complex object from its representation so that the same construction processes can create different representations.</p>

  <p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒè¡¨ç¤ºã€‚ï¼ˆä¸­æ–‡ç‰ˆä¹¦é‡Œçš„ç¿»è¯‘ï¼‰</p>
</blockquote>

<p>Builder åœ¨ã€Šè®¾è®¡æ¨¡å¼ã€‹çš„ä¸­æ–‡ç‰ˆé‡Œè¾¹ç¿»è¯‘ä¸ºâ€œç”Ÿæˆå™¨â€ï¼Œé‚£æˆ‘å°±æŒ‰è¿™ä¸ªè¯‘æ³•å§ã€‚ç”Ÿæˆå™¨æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼ˆCreational patternsï¼‰ï¼Œå®ƒå…³æ³¨å¦‚ä½•åˆ›å»ºå¯¹è±¡ã€‚å½“éœ€è¦æ„å»ºçš„å¯¹è±¡æ¯”è¾ƒå¤æ‚ï¼Œç”±å¤šä¸ªéƒ¨åˆ†ç»„æˆï¼Œä¹Ÿå°±è¯´å®ƒçš„æ„é€ æ–¹æ³•ä¼šæœ‰å¾ˆå¤šå‚æ•°ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™ç§æ¨¡å¼ã€‚ç”Ÿæˆå™¨æ¨¡å¼è®¤ä¸ºå¯¹è±¡çš„æ„å»ºæœºåˆ¶åº”è¯¥ç‹¬ç«‹äºå®ƒçš„ç»„æˆéƒ¨åˆ†ï¼ˆä¹Ÿå°±æ˜¯å±æ€§ï¼‰ï¼Œå¯¹è±¡çš„<strong>æ„å»ºè¿‡ç¨‹</strong>ä¸å…³æ³¨å¯¹è±¡çš„<strong>ç»„æˆéƒ¨åˆ†</strong>ã€‚æ‰€ä»¥åŒä¸€ä¸ªæ„å»ºè¿‡ç¨‹å¯ä»¥æ„å»ºå‡ºä¸åŒè¡¨ç¤ºï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ï¼ˆé€šè¿‡<strong>æ”¹å˜æ„å»ºæ­¥éª¤</strong>ï¼‰ã€‚<!--more-->åœ¨ GoF ä¹¦ä¸­çš„ç”Ÿæˆå™¨æ¨¡å¼ UML ç±»å›¾å¦‚ä¸‹ï¼š</p>

<p><img src="/img/builder-pattern.png" alt="Builder" /></p>

<p>ä¸Šå›¾ä¸­ï¼ŒProduct æ˜¯æ‰€è¦åˆ›å»ºçš„å¤æ‚å¯¹è±¡ï¼ŒConcreteBuilder ç±»è¡¨ç¤ºå…·ä½“çš„ç”Ÿæˆå™¨ï¼Œå®ƒå®ç°äº† Builder æ¥å£ï¼Œè´Ÿè´£ç»„è£…æ„æˆæœ€ç»ˆå¯¹è±¡çš„å„éƒ¨åˆ†ã€‚ConcreteBuilder å®šä¹‰äº†<strong>æ„å»ºè¿‡ç¨‹</strong>å’Œ<strong>å¯¹è±¡ç»„è£…æœºåˆ¶</strong>ï¼Œå°±æ˜¯å¦‚ä½•ç”¨å„éƒ¨åˆ†ã€æŒ‰ç…§æ€æ ·çš„æ­¥éª¤å»æ„é€ ä¸€ä¸ª Product å¯¹è±¡ã€‚ConcreteBuilder è¿˜å®šä¹‰äº† getResult() æ–¹æ³•ï¼Œç”¨äºè¿”å›æ„å»ºå¥½çš„ Product å¯¹è±¡ã€‚ç„¶å Director åˆ™æ˜¯è´Ÿè´£é€šè¿‡ä½¿ç”¨ Builder æ¥å£å»æ„å»ºæœ€ç»ˆæ‰€éœ€çš„ Product å¯¹è±¡ï¼Œå°±æ˜¯åšæŒ‡æŒ¥çš„ã€‚</p>

<p>ä»¥ä¸Šæ˜¯å¯¹ç»å…¸çš„ GoF ç”Ÿæˆå™¨æ¨¡å¼çš„è§£è¯»ï¼Œä¸‹é¢ç»“åˆå…·ä½“çš„ä¾‹å­åŠ æ·±ç†è§£ã€‚</p>

<h3 id="å…·ä½“ç®€å•ä¾‹å­">å…·ä½“ç®€å•ä¾‹å­</h3>

<p>åœ¨è¿™ä¸ªä¾‹å­é‡Œä¼šæœ‰è¿™äº›å‚ä¸è€…ï¼šBuilder, Car, MotorCycle, Product, ä»¥åŠ Directorã€‚å…¶ä¸­ï¼ŒCar, MotorCycle æ˜¯å®ç°äº† Builder æ¥å£çš„å…·ä½“ç±»ã€‚Builder ç”¨äºæ„å»º Product å¯¹è±¡çš„å„éƒ¨åˆ†ï¼ŒProduct åˆ™æ˜¯è¦è¢«åˆ›å»ºçš„å¤æ‚å¯¹è±¡ï¼ˆå°è½¦æˆ–æ‘©æ‰˜è½¦ï¼‰ã€‚å› ä¸º Car å’Œ MotorCycle éƒ½å®ç°äº† Builder æ¥å£ï¼Œæ‰€ä»¥éœ€è¦å®ç°æ¥å£ä¸­çš„æ–¹æ³•ï¼Œå³ <code>startUpOperations()</code>, <code>buildBody()</code>, <code>insertWheels()</code>, <code>addHeadLights()</code>, <code>endOperations()</code>, å’Œ <code>getVehicle()</code> æ–¹æ³•ã€‚å‰äº”ä¸ªæ–¹æ³•å¥½ç†è§£ï¼Œå¯¹åº”è½½å…·çš„æ„å»ºè¿‡ç¨‹ï¼Œå¼€å§‹ï¼Œæ„å»ºè½¦èº«ï¼Œè£…è½®å­ï¼Œè£…å¤´ç¯ï¼Œæ”¶å°¾ã€‚è€Œ <code>getVehicle()</code> æ–¹æ³•ï¼Œå°±æ˜¯è¿”å›å·²æ„å»ºå¥½çš„è½½å…·ã€‚ ç„¶åè¿˜æœ‰ Directorï¼Œå®ƒè°ƒç”¨åŒä¸€ä¸ª <code>construct()</code> æ–¹æ³•å»æ„å»ºä¸åŒç±»å‹çš„è½½å…·ã€‚è¿™ä¸ªå…·ä½“ä¾‹å­çš„ç±»å›¾å¦‚ä¸‹ï¼š</p>

<p><img src="/img/builder-pattern-vehicles.png" alt="builder-pattern-vehicles" /></p>

<h4 id="ä»£ç å®ç°">ä»£ç å®ç°</h4>

<pre><code class="language-java">import java.util.LinkedList;

// å…¬å…±æ¥å£
interface Builder {
	void startUpOperations();
	void buildBody();
	void insertWheels();
	void addHeadlights();
	void endOperations();

	/* ç”¨äºè·å–å·²ç»æ„å»ºå¥½çš„å¯¹è±¡çš„æ–¹æ³•ã€‚*/
	Product getVehicle();
}

// Car ç±»
class Car implements Builder {
	private String brandName;
	private Product product;

	public Car(String brand) {
		product = new Product();
		this.brandName = brand;
	}

	public void startUpOperations() {
		// å¼€å§‹å°±è®¾ç½®å“ç‰Œåç§°
		product.add(String.format("Car model is :%s", this.brandName));
	}

	public void buildBody() {
		product.add("This is a body of a Car");
	}

	public void insertWheels() {
		product.add("4 wheels are added");
	}

	public void addHeadlights() {
		product.add("2 Headlights are added");
	}

	public void endOperations() { // Nothing in this case
	}

	public Product getVehicle() {
		return product;
	}
}

// Motorcycle ç±»
class MotorCycle implements Builder {
	private String brandName;
	private Product product;

	public MotorCycle(String brand) {
		product = new Product();
		this.brandName = brand;
	}

	public void startUpOperations() { // Nothing in this case
	}

	public void buildBody() {
		product.add("This is a body of a Motorcycle");
	}

	public void insertWheels() {
		product.add("2 wheels are added");
	}

	public void addHeadlights() {
		product.add("1 Headlights are added");
	}

	public void endOperations() {
		// æ·»åŠ å“ç‰Œåç§°ä½œä¸ºæ”¶å°¾
		product.add(String.format("Motorcycle model is :%s", this.brandName));
	}

	public Product getVehicle() {
		return product;
	}
}

// Product ç±» 
class Product {
	/*
	 * ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®ç»“æ„ï¼Œè¿™é‡Œä½¿ç”¨
	 * LinkedList&lt;String&gt; 
	 */
	private LinkedList&lt;String&gt; parts;

	public Product() {
		parts = new LinkedList&lt;String&gt;();
	}

	public void add(String part) {
		// æ·»åŠ éƒ¨ä»¶
		parts.addLast(part);
	}

	public void showProduct() {
		System.out.println("\nProduct completed as below :");
		for (String part : parts)
			System.out.println(part);
	}
}

// Director ç±» 
class Director {
	Builder builder;

	// Director çŸ¥é“å¦‚ä½•ä½¿ç”¨ builder ä»¥åŠè°ƒç”¨æ­¥éª¤ã€‚
	public void construct(Builder builder) {
		this.builder = builder;
		builder.startUpOperations();
		builder.buildBody();
		builder.insertWheels();
		builder.addHeadlights();
		builder.endOperations();
	}
}

public class BuilderPatternExample {

	public static void main(String[] args) {
		System.out.println("***Builder Pattern Demo***");
		Director director = new Director();

		Builder fordCar = new Car("Ford");
		Builder hondaMotorycle = new MotorCycle("Honda");

		// é€ å°è½¦ Car
		director.construct(fordCar);
		Product p1 = fordCar.getVehicle();
		p1.showProduct();

		// é€ æ‘©æ‰˜ MotorCycle
		director.construct(hondaMotorycle);
		Product p2 = hondaMotorycle.getVehicle();
		p2.showProduct();
	}
}

</code></pre>

<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>

<pre><code class="language-console">***Builder Pattern Demo***

Product completed as below :
Car model is :Ford
This is a body of a Car
4 wheels are added
2 Headlights are added

Product completed as below :
This is a body of a Motorcycle
2 wheels are added
1 Headlights are added
Motorcycle model is :Honda
</code></pre>

<h3 id="q--a">Q &amp; A</h3>

<ol>
  <li>
    <p>ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„?</p>

    <ul>
      <li>ä½ å¯ä»¥ç”¨ç”Ÿæˆå™¨æ¨¡å¼é€æ­¥æ„å»ºå¤æ‚å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥æ”¹å˜æ„å»ºæ­¥éª¤ã€‚é€šè¿‡éšè—æ„å»ºå¤æ‚å¯¹è±¡çš„ç»†èŠ‚ï¼ˆæ„å»ºæ¯éƒ¨åˆ†çš„ç»†èŠ‚ï¼‰ï¼ŒåŠ å¼ºäº†å°è£…æ€§ã€‚ Director å¯ä»¥ä» Builder è·å–æœ€ç»ˆæ„å»ºå®Œæˆçš„ Productï¼Œåœ¨è¡¨é¢çœ‹äº†å°±å¥½åƒåªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼ˆconstruct()ï¼‰ç”¨äºæ„å»ºæœ€ç»ˆäº§å“ï¼Œå…¶ä»–çš„å†…éƒ¨æ–¹æ³•åªæ˜¯æ¶‰åŠæ„å»ºå…·ä½“çš„éƒ¨åˆ†ã€‚</li>
      <li>ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼ŒåŒæ ·çš„æ„å»ºè¿‡ç¨‹ï¼Œå¯ä»¥äº§ç”Ÿä¸åŒçš„äº§å“ã€‚</li>
      <li>å› ä¸ºä½ å¯ä»¥æ”¹å˜æ„é€ æ­¥éª¤ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ”¹å˜äº§å“çš„å†…éƒ¨è¡¨ç¤ºã€‚</li>
    </ul>
  </li>
  <li>
    <p>ç”Ÿæˆå™¨æ¨¡å¼çš„åå¤„ï¼Ÿ</p>

    <ul>
      <li>ä¸é€‚ç”¨äºå¤„ç†å¯å˜å¯¹è±¡ï¼ˆmutable objectï¼‰ï¼Œå³åˆ›å»ºåå¯è¢«ä¿®æ”¹çš„å¯¹è±¡ã€‚</li>
      <li>å¯èƒ½éœ€è¦å†™äº›é‡å¤ä»£ç ï¼Œä¾‹å¦‚ä¸åŒçš„å…·ä½“ç”Ÿæˆå™¨æœ‰äº›ä»£ç ç±»ä¼¼æˆ–é‡å¤ï¼ŒæŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šæœ‰ä¸å¥½çš„å½±å“ï¼Œå¹¶å¯èƒ½æˆä¸º<em><a href="https://blog.csdn.net/jiangpingjiangping/article/details/78067595">åæ¨¡å¼</a></em>ã€‚</li>
      <li>ä¸€ä¸ªå…·ä½“çš„ç”Ÿæˆå™¨ä¸“ç”¨äºäº§ç”ŸæŸç±»äº§å“ï¼Œæ‰€ä»¥è¦ç”Ÿäº§å¦ä¸€ç±»äº§å“ï¼Œå°±éœ€è¦ç¼–å†™ä¸€ä¸ªç”¨äºè¯¥ç±»äº§å“çš„å…·ä½“ç”Ÿæˆå™¨ã€‚</li>
      <li>ç”Ÿæˆå™¨æ¨¡å¼åªæœ‰åœ¨æ„å»ºæ¯”è¾ƒå¤æ‚çš„å¯¹è±¡æ—¶ç”¨æ‰æœ‰ä¼˜åŠ¿ã€‚</li>
    </ul>
  </li>
  <li>
    <p>åœ¨ä¸Šé¢ä¾‹å­ä¸­æˆ‘å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»è€Œä¸æ˜¯æ¥å£å—ï¼Ÿ</p>

    <ul>
      <li>å¯ä»¥çš„ã€‚ä½ å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»ï¼Œè€Œä¸æ˜¯ç”¨æ¥å£ã€‚</li>
    </ul>
  </li>
  <li>
    <p>å¦‚ä½•ç¡®å®šåº”è¯¥ä½¿ç”¨æŠ½è±¡ç±»è¿˜æ˜¯æ¥å£ï¼Ÿ</p>

    <ul>
      <li>å¦‚æœä½ æƒ³è¦ä¸€äº›é›†ä¸­çš„æˆ–æ˜¯é»˜è®¤çš„è¡Œä¸ºï¼Œé‚£ä¹ˆæŠ½è±¡ç±»æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥æä¾›ä¸€äº›é»˜è®¤çš„å®ç°ã€‚å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨æ¥å£åˆ™éœ€è¦ä»é›¶å¼€å§‹å®ç°ï¼Œæ¥å£å®šä¹‰äº†æŸäº›è§„åˆ™/å¥‘çº¦ï¼Œå¼ºè°ƒåº”è¯¥åšä»€ä¹ˆï¼Œä½†ä¸å¼ºè°ƒæ€ä¹ˆåšã€‚è¿˜æœ‰å°±æ˜¯å¦‚æœè¦è€ƒè™‘å®ç°å¤šç»§æ‰¿ï¼Œæ¥å£å°±æ›´åˆé€‚ã€‚ å¦‚æœä½ è¦ç»™æ¥å£æ·»åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£çš„æ‰€æœ‰å®ç°éƒ½éœ€è¦å®ç°è¿™ä¸ªæ–°æ–¹æ³•ï¼Œæœ‰ç‚¹éº»çƒ¦ã€‚ä½†å¦‚æœåœ¨æŠ½è±¡ç±»ä¸­æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå¹¶æœ‰é»˜è®¤å®ç°ï¼Œé‚£ä¹ˆæ—§ä»£ç ä¸å—å½±å“ã€‚åœ¨ Java 8 å¼•å…¥äº† <code>default</code> å…³é”®å­—åœ¨æ¥å£çš„ç”¨æ³•ï¼Œå¯ä»¥åœ¨æ¥å£é‡Œæä¾›é»˜è®¤æ–¹æ³•ã€‚</li>
      <li>ä¸‹é¢æ˜¯æŠ½è±¡ç±»æ›´é€‚ç”¨çš„åœºæ™¯ï¼š
        <ul>
          <li>æƒ³è¦åœ¨å¤šä¸ªè”ç³»ç´§å¯†çš„ç±»ä¹‹é—´å…±äº«ä»£ç </li>
          <li>è¢«ç»§æ‰¿çš„æŠ½è±¡ç±»æœ‰å¾ˆå¤šå…¬å…±æ–¹æ³•æˆ–å­—æ®µï¼Œæˆ–è€…å®ƒä»¬å½“ä¸­éœ€è¦éå…¬æœ‰è®¿é—®ä¿®é¥°ç¬¦ã€‚</li>
          <li>ä½ æƒ³ä½¿ç”¨éé™æ€æˆ–é <code>final</code> å­—æ®µï¼Œè¿™æ ·å¯ä»¥ä¿®æ”¹å…¶æ‰€å±å¯¹è±¡çš„çŠ¶æ€ã€‚</li>
        </ul>
      </li>
      <li>æ¥ä¸‹æ¥æ˜¯ä½¿ç”¨æ¥å£æ›´åˆé€‚çš„åœºæ™¯ï¼š
        <ul>
          <li>å¸Œæœ›ä¸€äº›ä¸ç›¸å…³çš„ç±»å®ç°ä½ çš„æ¥å£ã€‚</li>
          <li>æŒ‡å®šæŸç§æ•°æ®ç±»å‹çš„è¡Œä¸ºï¼Œä½†æ˜¯ä¸å…³å¿ƒå¦‚ä½•å®ç°ã€‚</li>
          <li>æƒ³è¦é€‚ç”¨å¤šç»§æ‰¿ã€‚</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>ä¸Šé¢ä¾‹å­ä¸­ï¼Œåœ¨ Car é‡Œï¼Œbrand name åœ¨ç¬¬ä¸€æ­¥æ·»åŠ äº†ï¼Œè€Œåœ¨ MotorCycle é‡Œï¼Œ brand name åœ¨æœ€åä¸€æ­¥æ·»åŠ ï¼Œè¿™æ˜¯æ•…æ„çš„å—ï¼Ÿ</p>

    <p>æ˜¯çš„ã€‚è¿™æ˜¯ä¸ºäº†è¯´æ˜ï¼Œæ¯ç§å…·ä½“ç”Ÿæˆå™¨å¯ä»¥è‡ªç”±å†³å®šå¦‚ä½•äº§ç”Ÿæœ€ç»ˆäº§å“ã€‚</p>
  </li>
  <li>
    <p>ä¸ºä»€ä¹ˆä½¿ç”¨å•ç‹¬ä¸€ä¸ªç±»ä½œä¸º Directorï¼Ÿåº”è¯¥å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯ä»£ç ï¼ˆclient codeï¼‰å……å½“ Director çš„è§’è‰²å•Šã€‚</p>

    <p>è¿™æ–¹é¢æ²¡æœ‰é™åˆ¶ã€‚ä¸Šé¢çš„ä»£ç ä¾‹å­ï¼Œå°† Director è§’è‰²ä¸å®¢æˆ·ç«¯ä»£ç åˆ†ç¦»ï¼Œä½†æ˜¯æ¥ä¸‹æ¥çš„ä¾‹å­ä¼šç›´æ¥é€‚ç”¨å®¢æˆ·ç«¯ä»£ç åš Directorã€‚</p>
  </li>
  <li>
    <p>å®¢æˆ·ç«¯ä»£ç ï¼ˆclient codeï¼‰æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>

    <p>åŒ…å« main() æ–¹æ³•çš„ç±»å°±æ˜¯å®¢æˆ·ç«¯ä»£ç ï¼ˆclient codeï¼‰ã€‚åœ¨ <em>Effective Java</em> ä¸€ä¹¦çš„ç¬¬ 4 é¡µï¼Œæœ‰ä¸‰æ®µè¯è®²äº†æœ¯è¯­ <em>exported API</em> ä»¥åŠ a <em>client</em> of the API. å¼•ç”¨å¦‚ä¸‹ï¼š</p>

    <blockquote>
      <p>This book uses a few technical terms that are not defined in <em>The Java Language Specification</em>. The term <em>exported API</em>, or simply <em>API</em>, refers to the classes, interfaces, constructors, members, and serialized forms by which a programmer accesses a class, interface, or package. (The term <em>API</em>, which is short for <em>application programming interface</em>, is used in preference to the otherwise preferable term <em>interface</em> to avoid confusion with the language construct of that name.) A programmer who writes a program that uses an API is referred to as a <em>user</em> of the API. A class whose implementation uses an API is a <em>client</em> of the API.</p>

      <p>Classes, interfaces, constructors, members, and serialized forms are collectively known as <em>API elements</em>. An exported API consists of the API elements that are accessible outside of the package that defines the API. These are the API elements that any client can use and the author of the API commits to support. Not coincidentally, they are also the elements for which the Javadoc utility generates documentation in its default mode of operation. Loosely speaking, the exported API of a package consists of the public and protected members and constructors of every public class or interface in the package.</p>

      <p>In Java 9, a <em>module system</em> was added to the platform. If a library makes use of the module system, its exported API is the union of the exported APIs of all the packages exported by the libraryâ€™s module declaration.</p>
    </blockquote>
  </li>
  <li>
    <p>å‰é¢æåˆ°æ”¹å˜æ„å»ºæ­¥éª¤ã€‚èƒ½å¦æ¼”ç¤ºä¸€ä¸‹é€šè¿‡æ”¹å˜æ„å»ºæ­¥éª¤äº§ç”Ÿä¸åŒçš„æœ€ç»ˆäº§å“ï¼Ÿ</p>

    <p>ä¸‹é¢çš„ä¾‹å­ç»™å‡ºæ¼”ç¤ºã€‚</p>
  </li>
</ol>

<h3 id="æ”¹è¿›ç‰ˆä¾‹å­">æ”¹è¿›ç‰ˆä¾‹å­</h3>

<p>æ”¹è¿›ç‰ˆä¾‹å­åšäº†å¦‚ä¸‹ä¿®æ”¹ï¼š</p>

<ul>
  <li>è¿™æ¬¡åªå…³æ³¨ Car ä½œä¸ºæœ€ç»ˆäº§å“ã€‚</li>
  <li>å®šåˆ¶ Car çš„æ„å»ºæ­¥éª¤åŒ…å«è¿™äº›ï¼š
    <ul>
      <li>å¼€å§‹çš„æ¶ˆæ¯ï¼ˆstartUpMessage)ã€‚</li>
      <li>å¤„ç†ç»“æŸæ¶ˆæ¯ï¼ˆendOperationsMessageï¼‰</li>
      <li>ç¡®å®šè½¦èº«ææ–™ï¼ˆbodyTypeï¼‰</li>
      <li>è½¦è½®æ•°é‡ï¼ˆnoOfWheelsï¼‰</li>
      <li>è½¦å¤´ç¯æ•°é‡ï¼ˆnoOfHeadLightsï¼‰</li>
    </ul>
  </li>
  <li>å®¢æˆ·ç«¯ä»£ç åŒæ—¶å……å½“äº† Director çš„è§’è‰²ã€‚</li>
  <li>ç”Ÿæˆå™¨çš„æ¥å£è¢«é‡å‘½åä¸º ModifiedBuilderï¼Œ é™¤ constructCar() å’Œ getConstructedCar() æ–¹æ³•å¤–ï¼Œæ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•çš„è¿”å›ç±»å‹éƒ½æ˜¯ ModifiedBuilderï¼Œè¿™æ ·å¯ä»¥å®ç°æ–¹æ³•é“¾ï¼ˆmethod chainingï¼‰ã€‚</li>
</ul>

<h4 id="ä»£ç å®ç°-1">ä»£ç å®ç°</h4>

<pre><code class="language-java">// å…¬å…±æ¥å£
interface ModifiedBuilder {
	/*
	 * æ‰€æœ‰è¿™äº›æ–¹æ³•çš„è¿”å›å€¼ç±»å‹éƒ½æ˜¯ ModifiedBuilderã€‚è¿™æ ·å¯ä»¥åšé“¾å¼è°ƒç”¨
	 */
	ModifiedBuilder startUpOperations(String startUpMessage);
	ModifiedBuilder buildBody(String bodyType);
	ModifiedBuilder insertWheels(int noOfWheels);
	ModifiedBuilder addHeadlights(int noOfHeadLights);
	ModifiedBuilder endOperations(String endOperationsMessage);

	/* ç»„åˆéƒ¨ä»¶åˆ¶é€ æœ€ç»ˆäº§å“ã€‚ */
	ProductClass constructCar();

	// å¯é€‰çš„æ–¹æ³•ï¼šè·å–å·²æ„å»ºçš„äº§å“
	ProductClass getConstructedCar();
}

//Car ç±»
class CarBuilder implements ModifiedBuilder {
    // é»˜è®¤èµ·å§‹æ¶ˆæ¯
	private String startUpMessage = "Start building the product";
    private String bodyType = "Steel"; // é»˜è®¤è½¦èº«ç±»å‹
	private int noOfWheels = 4; // é»˜è®¤è½¦è½®æ•°é‡
	private int noOfHeadLights = 2; // é»˜è®¤è½¦å¤´ç¯æ•°é‡
	// é»˜è®¤ç»“æŸæ¶ˆæ¯
	private String endOperationsMessage = "Product creation completed";
	ProductClass product;

	@Override
	public ModifiedBuilder startUpOperations(String startUpMessage) {
		this.startUpMessage = startUpMessage;
		return this;
	}

	@Override
	public ModifiedBuilder buildBody(String bodyType) {
		this.bodyType = bodyType;
		return this;
	}

	@Override
	public ModifiedBuilder insertWheels(int noOfWheels) {
		this.noOfWheels = noOfWheels;
		return this;
	}

	@Override
	public ModifiedBuilder addHeadlights(int noOfHeadLights) {
		this.noOfHeadLights = noOfHeadLights;
		return this;
	}

	@Override
	public ModifiedBuilder endOperations(String endOperationsMessage) {
		this.endOperationsMessage = endOperationsMessage;
		return this;
	}

	@Override
	public ProductClass constructCar() {

		product = new ProductClass(this.startUpMessage, this.bodyType,
                                   this.noOfWheels, this.noOfHeadLights,
				this.endOperationsMessage);
		return product;
	}

    @Override
	public ProductClass getConstructedCar() {
		return product;
	}
}

// Product ç±» 
final class ProductClass {
	private String startUpMessage;
	private String bodyType;
	private int noOfWheels;
	private int noOfHeadLights;
	private String endOperationsMessage;

	public ProductClass(final String startUpMessage, String bodyType,
                        int noOfWheels, int noOfHeadLights,
			String endOperationsMessage) {
		this.startUpMessage = startUpMessage;
		this.bodyType = bodyType;
		this.noOfWheels = noOfWheels;
		this.noOfHeadLights = noOfHeadLights;
		this.endOperationsMessage = endOperationsMessage;
	}
	/*
	 * æ²¡æœ‰ä½¿ç”¨ setter æ–¹æ³•ï¼ŒåŠ å¼ºä¸å¯ä»¥å˜æ€§ã€‚å› ä¸ºå±æ€§æ˜¯ç§æœ‰ï¼Œä¸”æ²¡æœ‰ setter æ–¹æ³•ï¼Œ
	 * æ‰€ä»¥ä¸å¿…è¦ä½¿ç”¨ final å…³é”®å­—ã€‚
	 */
	@Override
	public String toString() {
		return "Product Completed as:\n startUpMessage=" + 
            startUpMessage + "\n bodyType=" + 
            bodyType + "\n noOfWheels=" + 
            noOfWheels + "\n noOfHeadLights=" + 
            noOfHeadLights + "\n endOperationsMessage=" + 
            endOperationsMessage;
	}
}

// Director ç±» 
public class BuilderPatternModifiedExample {

	public static void main(String[] args) {
		System.out.println("***Modified Builder Pattern Demo***");
		/*
		 * æ„é€ ä¸€ä¸ªå®šåˆ¶çš„å°è½¦ï¼ˆé€šè¿‡ä½¿ç”¨ builderï¼‰ï¼Œæ³¨æ„æ­¥éª¤ï¼š
		 * ç¬¬1æ­¥ï¼šå·²å¿…è¦çš„å‚æ•°è·å–ä¸€ä¸ª builder å¯¹è±¡ã€‚
		 * ç¬¬2æ­¥ï¼šä½¿ç”¨ç±»ä¼¼ setter çš„æ–¹æ³•è®¾ç½®å¯é€‰å­—æ®µã€‚
		 * ç¬¬3æ­¥ï¼šè°ƒç”¨ constructCar() æ–¹æ³•å»è·å–æœ€ç»ˆç”Ÿæˆçš„å°è½¦ã€‚
		 */
		final ProductClass customCar1 = new CarBuilder()
            .addHeadlights(5)
            .insertWheels(5)
            .buildBody("Plastic")
			.constructCar();
		System.out.println(customCar1);
		System.out.println("--------------");
		/*
		 * ç”¨ä¸åŒçš„æ­¥éª¤æ„é€ å¦ä¸€ä¸ªå®šåˆ¶å°è½¦ï¼ˆé€šè¿‡ä½¿ç”¨ builderï¼‰
		 */
		ModifiedBuilder carBuilder2 = new CarBuilder();
		final ProductClass customCar2 = carBuilder2
            .insertWheels(7)
            .addHeadlights(6)
            .startUpOperations("I am making my own car")
            .constructCar();
		System.out.println(customCar2);
		System.out.println("--------------");
		/*
		 * é”™è¯¯ï¼Œå› ä¸º customCar2 æ˜¯ final çš„
         * customCar2 = carBuilder2.insertWheels(70)
		 * .addHeadlights(6) .startUpOperations("I am making my own car")
		 * .constructCar(); System.out.println(customCar2);
		 */		
		// éªŒè¯ getConstructedCar() æ–¹æ³•
        
		final ProductClass customCar3 = carBuilder2.getConstructedCar();
		System.out.println(customCar3);
	}
}

</code></pre>

<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>

<pre><code class="language-console">***Modified Builder Pattern Demo***
Product Completed as:
startUpMessage=Start building the product
bodyType=Plastic
noOfWheels=5
noOfHeadLights=5
endOperationsMessage=Product creation completed
--------------
Product Completed as:
startUpMessage=I am making my own car
bodyType=Steel
noOfWheels=7
noOfHeadLights=6
endOperationsMessage=Product creation completed
--------------
Product Completed as:
startUpMessage=I am making my own car
bodyType=Steel
noOfWheels=7
noOfHeadLights=6
endOperationsMessage=Product creation completed
</code></pre>

<p>åœ¨æ”¹è¿›ç‰ˆä¾‹å­ä¸­ï¼Œç¬¬ 124 è¡Œï¼Œæ„å»º <code>customCar1</code>ï¼Œé€æ­¥è°ƒç”¨äº† <code>addHeadLights()</code>, <code>insertWheels()</code>, <code>buildBody()</code> æ–¹æ³•ã€‚ ç„¶åå½“æ„å»º <code>customCar2</code> æ—¶ï¼Œæ–¹æ³•çš„è°ƒç”¨é¡ºåºä¸åŒäº†ï¼Œè€Œæ²¡è°ƒç”¨çš„æ–¹æ³•ï¼Œä¼šå–é»˜è®¤å€¼ã€‚</p>

<h3 id="q--a-1">Q &amp; A</h3>

<ol>
  <li>
    <p>æ”¹è¿›ç‰ˆä¾‹å­ä¸­å®¢æˆ·ç«¯ä»£ç ç”¨åˆ° <code>final</code> å…³é”®å­—ï¼Œä½†æ˜¯ <code>ProductClass</code> çš„å±æ€§å´æ²¡æœ‰ç”¨ <code>final</code> å…³é”®å­—ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p>

    <p>åœ¨å®¢æˆ·ç«¯ä»£ç ä½¿ç”¨ <code>final</code> å…³é”®å­—æ˜¯ä¸ºäº†æé«˜ä¸å¯ä¿®æ”¹æ€§ï¼ˆimmutabilityï¼‰ï¼Œä½†æ˜¯åœ¨ <code>ProductClass</code> å±æ€§å·²ç»æ˜¯ç§æœ‰ä¸”é‚£ä¸ªç±»æ²¡æœ‰ setter æ–¹æ³•ï¼Œæ‰€ä»¥å·²ç»æ˜¯ä¸å¯ä¿®æ”¹äº†ï¼Œä¸éœ€è¦ä½¿ç”¨ <code>final</code> å…³é”®å­—ã€‚</p>
  </li>
  <li>
    <p>ä¸å¯ä¿®æ”¹çš„å¯¹è±¡æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</p>

    <p>è¿™æ ·çš„å¯¹è±¡ä¸€æ—¦æ„å»ºå®Œæˆï¼Œå°±å¯ä»¥å®‰å…¨åœ°å…±äº«ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒä»¬æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆthread-safeï¼‰ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­çœå»äº†å¾ˆå¤šåŒæ­¥æ“ä½œã€‚</p>
  </li>
  <li>
    <p>ä½•æ—¶åº”è¯¥è€ƒè™‘ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼ï¼Ÿ</p>

    <p>å½“ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šæ­¥éª¤ï¼Œè€Œä¸”è¢«åˆ›å»ºçš„å¯¹è±¡éœ€è¦æ˜¯ä¸å¯ä¿®æ”¹çš„å¯¹è±¡ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼ã€‚</p>
  </li>
</ol>

<h3 id="è¡¥å……">è¡¥å……</h3>

<h4 id="é™æ€åµŒå¥—ç±»é“¾å¼è°ƒç”¨">é™æ€åµŒå¥—ç±»ï¼Œé“¾å¼è°ƒç”¨</h4>

<p>è¿™é‡Œè¡¥å…… Effective Java ç¬¬ä¸‰ç‰ˆé‡Œè¾¹ Item 2 æ‰€è®²çš„ <strong>Consider a builder when faced with many constructor parameters</strong> çš„ä»£ç ä¾‹å­ï¼Œå› ä¸ºè§‰å¾—è¿™é‡Œé¢çš„ä¾‹å­ç¨å¾®é«˜çº§ä¸€ç‚¹ï¼Œåº”ç”¨åˆ°é™æ€åµŒå¥—ç±»ï¼ˆä¸çŸ¥é“è¿™æ ·ç¿»è¯‘å‡†ä¸å‡†ç¡®ï¼Œè‹±æ–‡æ˜¯ Static nested classï¼‰ã€‚ åœ¨è¯´å®Œ Telescoping constructor pattern (does not scale well!) å’Œ JavaBeans Pattern (allows inconsistency, mandates mutability) ç¼ºç‚¹ä¹‹åï¼ŒJoshua Bloch ç»™å‡ºäº†ä¸€ç§ Builder Patternï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<pre><code class="language-java">// Builder Pattern
public class NutritionFacts {
    private final int servingSize;
    private final int servings;
    private final int calories;
    private final int fat;
    private final int sodium; // é’ 
    private final int carbohydrate; // ç¢³æ°´åŒ–åˆç‰©
    
    // ç”¨ Static nested class ä½œä¸º Builder
    // æ”¾åœ¨è¿™é‡Œé¢å¯ä»¥ convey ä¸€ç§ ownershipï¼Œ
    // è¯´æ˜è¿™ä¸ª Builder ç”¨äºç”Ÿæˆ NutritionFacts
    public static class Builder {
        // Required parameters å¿…é¡»çš„å‚æ•°
        private final int servingSize;
        private final int servings;
        
        // Optional parameters - initialized to default values
        // å¯é€‰å‚æ•°ï¼Œåˆå§‹åŒ–ä¸ºé»˜è®¤å€¼
        private int calories     = 0;
        private int fat          = 0;
        private int sodium       = 0;
        private int carbohydrate = 0;
        
        public Builder(int servingSize, int servings) {
            this.servingSize = servingSize;
            this.servings    = servings;
        }
        
        // è¡¨ç¤ºå„ä¸ªæ„é€ æ­¥éª¤ï¼Œè¿”å› Builder è‡ªèº«å¼•ç”¨ï¼Œå½¢æˆ fluent API é“¾å¼è°ƒç”¨
        public Builder calories(int val)
        	{ calories = val;  return this; }
        public Builder fat(int val)
        	{ fat = val;  return this; }
        public Builder sodium(int val)
        	{ sodium = val;  return this; }        
        public Builder carbohydrate(int val)
        	{ carbohydrate = val;  return this; }
        
        // è¿”å›æœ€ç»ˆäº§å“
        public NutritionFacts build() {
            return new NutritionFacts(this);
        }
    }
    
    // ç§æœ‰æ„é€ å‡½æ•°
    private NutritionFacts(Builder builder) {
        servingSize  = builder.servingSize;
        servings     = builder.servings;
        calories     = builder.calories;
        fat          = builder.fat;
        sodium       = builder.sodium;
        carbohydrate = builder.carbohydrate;
    }
        
}
</code></pre>

<p>æŒ‰ä¸Šé¢çš„ Builder å®ç°ï¼Œå®¢æˆ·ç«¯ä»£ç å¯ä»¥è¿™æ ·å†™ï¼š</p>

<pre><code class="language-java">NutritionFacts cocaCola = new NutritionFacts.Builder(240, 8).
    calories(100).sodium(35).carbohydrate(27).build();
</code></pre>

<p>è¿™æ ·çš„é“¾å¼è°ƒç”¨ï¼Œæ˜“å†™ã€æ˜“è¯»ï¼Œæ¨¡ä»¿äº†åƒ Python æˆ– Scala ä¸­çš„å‘½åå‚æ•°ï¼ˆnamed optional parameters).</p>

<h4 id="é€‚ç”¨äºç±»ç»§æ‰¿ä½“ç³»ç»“æ„">é€‚ç”¨äºç±»ç»§æ‰¿ä½“ç³»ç»“æ„</h4>

<p>å³æŠ½è±¡ç±»æœ‰æŠ½è±¡ builderï¼Œå…·ä½“ç±»æœ‰å…·ä½“çš„ builderï¼Œä¾‹å¦‚ä»¥ä¸‹ä»£ç æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œä»£è¡¨å„ç§æŠ«è¨ï¼š</p>

<pre><code class="language-java">// Builder pattern for class hierarchies
public abstract class Pizza {
    public enum Topping { HAM, MUSHROOM, ONION, PEPPER, SAUSAGE }
    final Set&lt;Topping&gt; toppings;
    
    abstract static class Builder&lt;T extends Builder&lt;T&gt;&gt; {
        EnumSet&lt;Topping&gt; toppings = EnumSet.noneOf(Topping.class);
        public T addTopping(Topping topping) {
            toppings.add(Objects.requireNonNull(topping));
            return self();
        }
        abstract Pizza build();
        
        // Subclasses must override this method to return "this"
        protected abstract T self();
    }
    Pizza(Builder&lt;?&gt; builder) {
        toppings = builder.toppings.clone();  // See Item 50
    }
}
</code></pre>

<p>ä¸Šé¢çš„ <code>Pizza.Builder</code> æ˜¯å¸¦æœ‰<em>é€’å½’ç±»å‹å‚æ•°</em>çš„æ³›å‹ï¼ŒåŠ ä¸ŠæŠ½è±¡çš„ <code>self</code> æ–¹æ³•ï¼Œå¯ä»¥å…è®¸å­ç±»å®ç°æ–¹æ³•é“¾å¼è°ƒç”¨ã€‚å› ä¸º Java æ²¡æœ‰ self ç±»å‹ï¼Œè¿™ç§åšæ³•æ˜¯æ¨¡ä»¿ self ç±»å‹çš„ä¹ æƒ¯ã€‚(This workaround for the fact that Java lacks a self type is known as the <strong>simulated self-type idiom</strong>.)</p>

<p>ç„¶åæ¥ä¸‹æ¥æ˜¯ä¸¤ä¸ªå…·ä½“çš„ <code>Pizza</code> å­ç±»ï¼š</p>

<p>çº½çº¦æŠ«è¨ï¼š</p>

<pre><code class="language-java">public class NyPizza extends Pizza {
    public enum Size { SMALL, MEDIUM, LARGE }
    private final Size size;
    
    public static class Builder extends Pizza.Builder&lt;Builder&gt; {
        private final Size size;
        
        // covariant return typing
        public Builder(Size size) {
            this.size = Objects.requiresNonNull(size);
        }
        @Override public NyPizza build() {
            return new NyPizza(this);
        }
        @Override protected Builder self() {
            return this;
        }
    }
    private NyPizza(Builder builder) {
        super(builder);
        size = builder.size;
    }
}
</code></pre>

<p>æ„å¼æŠ«è¨ï¼š</p>

<pre><code class="language-java">public class Calzone extends Pizza {
    private final boolean sauceInside;
    
    public static class Builder extends Pizza.Builder&lt;Builder&gt; {
        private final boolean sanceInside = false; // Default
        
        // covariant return typing
        public Builder sauceInside() {
            sauceInside = true;
            return this;
        }
        @Override public Calzone build() {
            return new Calzone(this);
        }
        @Override protected Builder self() { return this; }
    }
    private Calzone(Builder builder) {
        super(builder);
        sauceInside = builder.sauceInside;
    }
}
</code></pre>

<p>ç„¶åå®¢æˆ·ç«¯ä»£ç çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>

<pre><code class="language-java">NyPizza pizza = new NyPizza.Builder(SAMLL)
    .addTopping(SAUSAGE).addTopping(ONION).buid();
Calzone calzone = new Calzone.Builder()
    .addTopping(HAM).sauceInside().build();
</code></pre>

<h3 id="æ€»ç»“">æ€»ç»“</h3>

<p>æ€»çš„æ¥è¯´ï¼Œå½“ä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°æˆ–è€…é™æ€å·¥å‚æœ‰è¾ƒå¤šçš„å‚æ•°æ—¶ï¼Œç”Ÿæˆå™¨æ¨¡å¼æ˜¯ä¸€ç§å¥½çš„é€‰æ‹©ï¼Œç‰¹åˆ«æ˜¯æœ‰äº›å‚æ•°æ˜¯å¯é€‰çš„ï¼Œæˆ–è€…ç±»å‹æ˜¯ç›¸åŒçš„ã€‚ã€å®Œç»“ã€‘</p>

<h3 id="å‚è€ƒ">å‚è€ƒ</h3>

<ul>
  <li>[Gamma95] Gamma, Erich, Richard Helm, Ralph Johnson, and John Vlissides. 1995. <em>Design Patterns: Elements of Reusable Object-Oriented Software.</em> Reading, MA: Addison-Wesley. ISBN: 0201633612</li>
  <li>Sarcar, Vaskaran. <em>Design Patterns in Java, Second Edition.</em> Apress, 2019</li>
  <li><a href="https://springframework.guru/gang-of-four-design-patterns/builder-pattern/">Springframework guru: Builder Pattern</a></li>
  <li>Joshua Block. <em>Effective Java, Third Edition.</em> Addison-Wesley, 2018</li>
  <li><a href="https://blog.csdn.net/jiangpingjiangping/article/details/78067595">è®¾è®¡æ¨¡å¼æ‚è°ˆâ€”â€”æ¨¡å¼ä¸åæ¨¡å¼ä¹‹äº‰</a></li>
</ul>

<blockquote>
  <p>æ›´æ–°è®°å½•ï¼š</p>

  <p>2020å¹´3æœˆ13æ—¥ ä¸‹åˆ3ç‚¹13åˆ† ä¿®æ­£ä¸€äº›é”™åˆ«å­—ï¼Œæ•´ç†ä¸€ä¸‹ä»£ç æ ¼å¼ï¼Œå’Œæ›¿æ¢æ³¨é‡Šä¸ºä¸­æ–‡ã€‚</p>
</blockquote>


        <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
        <div id="lv-container" data-id="city" data-uid="MTAyMC80MTE2My8xNzcxMQ==">
            <script type="text/javascript">
            (function(d, s) {
                var j, e = d.getElementsByTagName(s)[0];
            
                if (typeof LivereTower === 'function') { return; }
            
                j = d.createElement(s);
                j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                j.async = true;
            
                e.parentNode.insertBefore(j, e);
            })(document, 'script');
            </script>
            <noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
        </div>
        <!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->

        <hr style="visibility: hidden;">

        <ul class="pager">
            
            <li class="previous">
                <a href="/2020/02/01/spring-classes/" data-toggle="tooltip" data-placement="top" title="Spring Bootçš„ç±»">
                ä¸Šä¸€ç¯‡<br>
                <span>Spring Bootçš„ç±»</span>
                </a>
            </li>
            
            
            <li class="next">
                <a href="/2020/02/04/inner-class/" data-toggle="tooltip" data-placement="top" title="Java å†…éƒ¨ç±»">
                ä¸‹ä¸€ç¯‡<br>
                <span>Java å†…éƒ¨ç±»</span>
                </a>
            </li>
            
        </ul>
    </div>  

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">ç›®å½•</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">ä¸»é¢˜æ ‡ç­¾</a></h5>
                    <div class="tags">
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Java" title="Java" rel="33">
                                    Java
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#ç¬”è¯•é¢è¯•" title="ç¬”è¯•é¢è¯•" rel="6">
                                    ç¬”è¯•é¢è¯•
                                </a>
                            
        				
                            
                				<a href="/tags/#OCA" title="OCA" rel="7">
                                    OCA
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#OCP" title="OCP" rel="4">
                                    OCP
                                </a>
                            
        				
                            
                				<a href="/tags/#Kotlin" title="Kotlin" rel="4">
                                    Kotlin
                                </a>
                            
        				
                            
                				<a href="/tags/#Tutorial" title="Tutorial" rel="6">
                                    Tutorial
                                </a>
                            
        				
                            
                				<a href="/tags/#Spring Boot" title="Spring Boot" rel="13">
                                    Spring Boot
                                </a>
                            
        				
                            
                				<a href="/tags/#Reactive" title="Reactive" rel="10">
                                    Reactive
                                </a>
                            
        				
                            
                				<a href="/tags/#æ•™ç¨‹" title="æ•™ç¨‹" rel="5">
                                    æ•™ç¨‹
                                </a>
                            
        				
                            
                				<a href="/tags/#ç¿»è¯‘" title="ç¿»è¯‘" rel="4">
                                    ç¿»è¯‘
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#RSocket" title="RSocket" rel="5">
                                    RSocket
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#JavaFX" title="JavaFX" rel="7">
                                    JavaFX
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#Notes" title="Notes" rel="5">
                                    Notes
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#1Z0-816" title="1Z0-816" rel="4">
                                    1Z0-816
                                </a>
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        // BY Fix:å»é™¤æ ‡é¢˜å‰çš„â€˜#â€™ issues:<https://github.com/qiubaiying/qiubaiying.github.io/issues/137>
        // anchors.options = {
        //   visible: 'always',
        //   placement: 'right',
        //   icon: '#'
        // };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>


<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <!-- add bilibili add target = "_blank" to <a> by Tao -->
                    
                    <li>
                        <a target="_blank" href="https://space.bilibili.com/86621709">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fas fa-tv fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <!-- add jianshu add target = "_blank" to <a> by BY -->
                    
                            <li>
                                <a target="_blank" href="https://www.jianshu.com/u/4f528075fae8">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fab  fa-stack-1x fa-inverse">ç®€</i>
                                    </span>
                                </a>
                            </li>
                    
                    
                    <li>
                        <a href="https://twitter.com/gdouzwt">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/1889654893">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/gdouzwt">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                </ul>
                <p class="copyright text-muted" style="text-align: center">
                    Copyright &copy; æ‹›æ–‡æ¡ƒ 2020 
Apache License Version 2.0                    <!-- <iframe src="https://ghbtns.com/github-btn.html?user=gdouzwt&repo=gdouzwt.github.io&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px">
                    </iframe> -->
                </p>
            </div>
        </div>
    </div>
    <!-- highlight -->
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/zwt.min.js "></script>

<script src="/js/prism.js "></script>

<!-- <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js"></script> -->

<!-- Service Worker -->

<script type="text/javascript">
    if(navigator.serviceWorker){
        // For security reasons, a service worker can only control the pages that are in the same directory level or below it. That's why we put sw.js at ROOT level.
        navigator.serviceWorker
            .register('/sw.js')
            .then((registration) => {console.log('Service Worker Registered. ', registration)})
            .catch((error) => {console.log('ServiceWorker registration failed: ', error)})
    }
</script>



<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/ 
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers   
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async('/js/jquery.tagcloud.js',function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- æ•°å­¦å…¬å¼ -->
<!--https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML-->

<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    config: ["MMLorHTML.js"],
    jax: ["input/TeX","input/MathML","input/AsciiMath","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
    extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
    TeX: {
      extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
    },
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEnvironments: true
    }
  });
</script>

<!--å¤è¯—è¯-->
<!-- SSL æœ‰é—®é¢˜ï¼Œå¼ƒç”¨ -->
<!-- <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script> -->

<!-- ç™¾åº¦ç»Ÿè®¡ å¼ƒç”¨ -->
<!-- <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e37b3c459855d395042e0ead932247db";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script> -->
    
<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {
        var P = $('div.post-container'),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>




<!-- Image to hack wechat -->
<img src="/img/apple-touch-icon.png" width="0" height="0"/>
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
